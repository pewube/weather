import { useContext } from "react";

import { AppContext } from "../context/AppContext";

import adjustWeatherIcon from "../utils/adjustWeatherIcon";
import formatWindDirection from "../utils/formatWindDirection";

const CurrentWeather = () => {
  const { weatherData } = useContext(AppContext);
  const data = weatherData.current;

  const weatherIconCode = adjustWeatherIcon(data?.weather[0]);
  const imgWeatherSrcValue = `/assets/img/ico-${weatherIconCode}.svg`;

  const updateDate = new Date(weatherData?.timestamp).toLocaleDateString("pl", {
    day: "2-digit",
    month: "2-digit",
    year: "numeric",
    hour: "2-digit",
    minute: "2-digit",
    second: "2-digit",
  });

  return (
    <article className="current">
      <header className="current__header">
        <section className="current__header__info">
          <p className="current__header__info__current">
            {data?.main.temp.toFixed(1)}&#176;C
          </p>
          <p className="current__info__feels-like">
            odczuwalna:{" "}
            <strong>{data?.main.feels_like.toFixed(1)}&#176;C</strong>
          </p>
          <p className="current__info__description">
            <strong>{data?.weather[0].description}</strong>
          </p>
        </section>
        <img
          className="current__header__icon-weather"
          src={imgWeatherSrcValue}
          alt={data?.weather[0].description}
          width="90"
          height="90"
        />
      </header>
      <section className="current__details">
        <p className="current__details__par--wide">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 96 960 960"
            width="24"
            height="24">
            <title>Prędkość wiatru</title>
            <path d="M438.461 976q0-18.384 16.577-29.192T500 936V700.308q-18.154-4.231-31.731-14.962-13.577-10.73-21.808-26.423l-104.922 65.231q-6.308 4.154-14.347 5.115-8.038.962-17.346-1.73l-180-51q-16.692-4.923-26.731-18.587Q93.077 644.289 93.077 627q0-21.846 14.577-36.423Q122.231 576 144.077 576h300.231q8.461-16.385 22.769-28.231 14.308-11.846 32.923-16.077V392.384q0-7.769 3.038-15.461 3.039-7.693 9.654-13.308l137-128q12.89-12.934 29.984-14.698 17.093-1.764 31.665 7.236 17.934 11.249 23.258 31.779 5.324 20.529-5.445 38.683l-153.615 253.77q17.769 11.23 26.269 35.615t1.808 46.308L727 664.923q8.308 2.461 14.769 6.692 6.462 4.231 9.847 11.308l91 164.769q8.846 15.462 6.487 32.235T833.769 909q-14.692 14.693-35.654 14.308-20.961-.385-36.423-15.077L556.154 702.693q-3.846 2.307-7.692 3.846-3.847 1.538-8.462 2.307V936q28.385 0 44.962 10.808T601.539 976H438.461ZM200 296v-40h200v40H200Zm340 96.384v139.308q.231 0 .346.115.116.116.346.116L695 277.46q2-4.023 1-8.549-1-4.527-5-6.527-3-2-7.5-1t-6.5 3l-137 128ZM80 456v-40h160v40H80Zm439.865 207.692q20.212 0 34.02-13.672 13.807-13.673 13.807-33.885 0-20.212-13.672-34.02-13.673-13.807-33.885-13.807-20.212 0-34.02 13.672-13.807 13.673-13.807 33.885 0 20.212 13.672 34.02 13.673 13.807 33.885 13.807ZM320.538 690l113-69.846q-.231-1.154-.231-2.077V616H144.288q-5.211 0-8.211 3t-3 8q0 4 2 7t6 4l179.461 52Zm396.693 13.462-130.923-32.154q-.462.461-.923 1.154-.462.692-.923 1.154l204.091 205.362q3.139 3.176 8.139 3.176t8-2.962q3-2.962 3.5-6.417.5-3.455-1.5-7.404l-89.461-161.909ZM160 896v-40h160v40H160Zm360-280Zm20.692-84.077ZM433.307 616Zm151.155 57.616Z" />
          </svg>
          <strong>
            {(data?.wind.speed * 3.6).toFixed(1)}
            {data?.wind.gust && ` - ${(data.wind.gust * 3.6).toFixed(1)}`} km/h
          </strong>
          <span className="ml-1">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              className="current__details__svg wind-direction"
              viewBox="0 96 960 960"
              width="24"
              height="24"
              style={{
                transform: `rotate(${data?.wind.deg - 180}deg)`,
                transformOrigin: "50% 50%",
              }}>
              <path d="m200 936-40-40 320-720 320 720-40 40-280-120-280 120Z" />
            </svg>
          </span>
          <span className="ml-10">{formatWindDirection(data?.wind.deg)}</span>
        </p>
        <p className="current__details__par">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 487.912 487.912">
            <title>Ciśnienie atmosferyczne</title>
            <path d="M203.206 304.912c2.6 0 5.2-1 7.1-3l20.3-20.6c4 1.9 8.5 3 13.2 3 16.9 0 30.7-13.7 30.7-30.6 0-4.6-1.1-8.9-2.9-12.7 0 0 .1 0 .1-.1l23.5-23.9v6.2c0 5.5 4.5 10 10 10s10-4.5 10-10v-30.5c0-5.5-4.4-10-10-10h-30.7c-5.5 0-10 4.5-10 10s4.5 10 10 10h6.7l-23.7 24.2-.1.1c-4.1-2-8.7-3.1-13.5-3.1-16.9 0-30.7 13.4-30.7 29.8 0 4.9 1.2 9.5 3.2 13.6l-20.3 20.6c-3.9 3.9-3.8 10.3.1 14.1 1.9 1.9 4.5 2.9 7 2.9zm40.7-60.999c5.8 0 10.7 4.5 10.7 9.8 0 6-4.7 10.6-10.7 10.6s-10.7-4.7-10.7-10.6c0-5.3 4.9-9.8 10.7-9.8z" />
            <path d="M292.206 66.213c6.4-19.3.5-41.1-15.8-54.2-18.1-16-46-16-64.9-.1-16.3 13.1-22.3 35-15.9 54.3-95.2 21.8-166.4 106.8-166.4 208.1 0 117.8 96.3 213.6 214.7 213.6s214.8-95.8 214.8-213.6c0-101.301-71.3-186.301-166.5-208.1zm-68.1-38.8c.1-.1.2-.1.2-.2 11.5-9.7 28.3-9.8 39-.2.1.1.3.2.4.4 10.5 8.4 13.8 23 8.4 35.1-9.2-1.2-18.7-1.8-28.2-1.8s-19 .6-28.2 1.8c-5.5-12.1-2.2-26.701 8.4-35.1zm19.8 440.499c-78.3 0-146-46.2-176.9-112.7h353.7c-30.8 66.5-98.5 112.7-176.8 112.7zm-86.4-294.9c50.1-41.3 122.8-41.3 172.9 0 47.7 39.3 60.4 106.7 31.1 162.2h-235.2c-29.2-55.499-16.6-122.9 31.2-162.2zm270.5 162.3h-44.3c12.1-27.4 16.2-57.8 11.3-87.3-5.8-35.5-24.3-67.6-51.9-90.4-57.5-47.3-140.8-47.3-198.3 0-27.6 22.8-46.1 54.9-51.9 90.4-4.9 29.5-.8 59.9 11.3 87.3h-45.2c-6.4-19.2-9.9-39.6-9.9-60.9.1-106.8 87.4-193.7 194.8-193.7s194.8 86.8 194.8 193.6c0 21.3-3.5 41.8-9.9 61h-.8z" />
          </svg>
          <strong>{data?.main.pressure} hPa</strong>
        </p>
        <p className="current__details__par">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 489 489">
            <title>Zachmurzenie</title>
            <path d="M367 159c-10.3 0-20.5 1.3-30.2 3.8-8.4-20.8-22.7-39.4-40.9-52.9-21.2-15.7-46.3-24-72.5-24-44.5 0-85.6 25.2-107.1 64.9-8.1-2.4-16.7-3.7-24.7-3.7-50.5 0-91.6 41.2-91.6 91.8s41.1 91.8 91.6 91.8h54c8.9 41.3 45.6 72.4 89.5 72.4H367c67.3 0 122-54.9 122-122.3 0-67.3-54.7-121.8-122-121.8zM143.5 310.2h-52c-39.4.2-71.5-32-71.5-71.6 0-39.6 32.1-71.8 71.6-71.8 8.3 0 17.7 1.9 25.9 5.3 5 2.1 10.7-.2 13-5.1 16.8-37.3 53.4-61.4 93-61.4 41.1 0 78.8 25.7 94.4 63.4-24.7 10.8-45.4 29.6-58.3 54-7.8-2.1-15.9-3.1-24.5-3.1-24.4 0-47.4 9.4-64.7 26.5-17.2 17-26.7 39.6-26.9 63.8zM367 382.8H235.1c-39.5 0-71.6-32.2-71.6-71.8 0-39.1 32.1-71 71.6-71 9.4 0 18 1.5 26.1 4.7 5 1.9 10.6-.4 12.8-5.4 15.9-36.7 52.4-60.4 93-60.4 56.3 0 102 45.6 102 101.6 0 56.4-45.8 102.3-102 102.3z" />
          </svg>
          <strong>{data?.clouds.all}%</strong>
        </p>
        <p className="current__details__par">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 96 960 960"
            width="24"
            height="24">
            <title>Widzialność (maks. 10km)</title>
            <path d="M480.181 702.154q60.973 0 103.473-42.681t42.5-103.654q0-60.973-42.681-103.473t-103.654-42.5q-60.973 0-103.473 42.681t-42.5 103.654q0 60.973 42.681 103.473t103.654 42.5ZM480 664q-45 0-76.5-31.5T372 556q0-45 31.5-76.5T480 448q45 0 76.5 31.5T588 556q0 45-31.5 76.5T480 664Zm.11 152q-129.956 0-236.879-70.731Q136.307 674.539 83.077 556q53.23-118.539 160.044-189.269Q349.934 296 479.89 296q129.956 0 236.879 70.731Q823.693 437.461 876.923 556q-53.23 118.539-160.044 189.269Q610.066 816 480.11 816ZM480 556Zm0 220q113 0 207.5-59.5T832 556q-50-101-144.5-160.5T480 336q-113 0-207.5 59.5T128 556q50 101 144.5 160.5T480 776Z" />
          </svg>
          <strong>{(data?.visibility / 1000).toFixed(1)} km</strong>
        </p>
        <p className="current__details__par">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 487.91 487.91">
            <title>Wilgotność</title>
            <path d="M244.065 53.968l-23.73 35.351C203.432 114.534 119.05 243.293 119.05 302.257c0 68.903 56.082 124.982 125.018 124.982 68.904 0 124.982-56.082 124.982-124.982 0-58.938-84.352-187.723-101.259-212.938zm.378 349.063c-17.806 0-47.236-9.413-67.256-28.47-22.07-21.008-33.925-52.676-33.925-72.305 0-4.77.703-15.971 4.658-27.972 5.65-17.144 15.227-40.157 26.59-62.885 6.414-12.831 14.229-25.414 21.447-38.05 17.35-30.365 36.002-56.963 48.487-77.256 11.396 18.515 29.995 45.924 46.432 74.467 8.084 14.04 16.012 26.176 23.027 40.115 11.482 22.814 21.563 46.268 27.196 62.926 4.389 12.978 4.12 22.98 4.12 28.277 0 19.402-9.45 51.157-31.053 72.15-20.08 19.511-51.688 29.004-69.722 29.004z" />
          </svg>

          <strong>{data?.main.humidity}%</strong>
        </p>
        <p className="current__details__par">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 488 488">
            <title>Wschód słońca</title>
            <path d="M124.6 420.85c1.8 1.9 4.4 2.9 7 2.9h.1l112.3-.8 112.4.8c2.7 0 5.2-1 7-2.9 1.9-1.9 3-4.4 3-7.1 0-43.8-23.3-84.6-60.9-106.5-38.1-21.7-85-21.7-122.3 0-38 21.6-61.6 62.4-61.6 106.5 0 2.7 1.1 5.2 3 7.1zm68.5-96.3c31.3-18.2 70.5-18.2 102.4 0 28.5 16.6 47.2 46.3 50.4 79.1l-101.9-.7-102 .7c3.2-32.9 22.2-62.6 51.1-79.1zM244 238.95c5.5 0 10-4.5 10-10v-50.8c0-5.5-4.5-10-10-10s-10 4.5-10 10v50.8c0 5.5 4.5 10 10 10zM376.3 290.55c2.6 0 5.1-1 7.1-3l41.3-41.6c3.8-3.9 3.8-10.2-.1-14.1-3.9-3.8-10.2-3.8-14.1.1l-41.3 41.6c-3.8 3.9-3.8 10.2.1 14.1 1.9 1.9 4.5 2.9 7 2.9zM104.6 287.55c2 2 4.5 3 7.1 3 2.6 0 5.1-1 7-2.9 4-3.8 4-10.2.1-14.1l-41.3-41.6c-3.8-4-10.2-4-14.1-.1-4 3.8-4 10.2-.1 14.1zM478 403.75h-50.5c-5.5 0-10 4.5-10 10s4.5 10 10 10H478c5.5 0 10-4.5 10-10s-4.5-10-10-10zM70.5 413.75c0-5.5-4.5-10-10-10H10c-5.5 0-10 4.5-10 10s4.5 10 10 10h50.5c5.5 0 10-4.5 10-10z" />
            <path d="M181.013 142.47l53-53v139.7c0 5.5 4.5 10 10 10s10-4.5 10-10V89.47l53 53c3.9 3.9 10.2 3.9 14.1 0 3.9-3.9 3.9-10.2 0-14.1l-70.1-70.1c-1.9-1.9-4.4-2.9-7.1-2.9-2.7 0-5.2 1.1-7.1 2.9l-70.1 70.1c-3.7 3.9-3.7 10.2.2 14.1 3.9 3.9 10.2 3.9 14.1 0z" />
          </svg>
          <strong>
            {new Date(data?.sys.sunrise * 1000)
              .toLocaleTimeString()
              .slice(0, 5)}
          </strong>
        </p>
        <p className="current__details__par">
          <svg
            className="current__details__svg"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 488 488">
            <title>Zachód słońca</title>
            <path d="M124.6 420.85c1.8 1.9 4.4 2.9 7 2.9h.1l112.3-.8 112.4.8c2.7 0 5.2-1 7-2.9 1.9-1.9 3-4.4 3-7.1 0-43.8-23.3-84.6-60.9-106.5-38.1-21.7-85-21.7-122.3 0-38 21.6-61.6 62.4-61.6 106.5 0 2.7 1.1 5.2 3 7.1zm68.5-96.3c31.3-18.2 70.5-18.2 102.4 0 28.5 16.6 47.2 46.3 50.4 79.1l-101.9-.7-102 .7c3.2-32.9 22.2-62.6 51.1-79.1zM244 238.95c5.5 0 10-4.5 10-10v-50.8c0-5.5-4.5-10-10-10s-10 4.5-10 10v50.8c0 5.5 4.5 10 10 10zM376.3 290.55c2.6 0 5.1-1 7.1-3l41.3-41.6c3.8-3.9 3.8-10.2-.1-14.1-3.9-3.8-10.2-3.8-14.1.1l-41.3 41.6c-3.8 3.9-3.8 10.2.1 14.1 1.9 1.9 4.5 2.9 7 2.9zM104.6 287.55c2 2 4.5 3 7.1 3 2.6 0 5.1-1 7-2.9 4-3.8 4-10.2.1-14.1l-41.3-41.6c-3.8-4-10.2-4-14.1-.1-4 3.8-4 10.2-.1 14.1zM478 403.75h-50.5c-5.5 0-10 4.5-10 10s4.5 10 10 10H478c5.5 0 10-4.5 10-10s-4.5-10-10-10zM70.5 413.75c0-5.5-4.5-10-10-10H10c-5.5 0-10 4.5-10 10s4.5 10 10 10h50.5c5.5 0 10-4.5 10-10z" />
            <path d="M236.95 236.214c1.9 1.9 4.4 2.9 7.1 2.9 2.7 0 5.2-1.1 7.1-2.9l70.1-70.1c3.8-3.8 3.8-10.2-.2-14.1-3.9-3.9-10.2-3.9-14.1 0l-53 53v-139.7c0-5.5-4.5-10-10-10s-10 4.5-10 10v139.7l-53-53c-3.9-3.9-10.2-3.9-14.1 0-3.9 3.9-3.9 10.2 0 14.1z" />
          </svg>
          <strong>
            {new Date(data?.sys.sunset * 1000).toLocaleTimeString().slice(0, 5)}
          </strong>
        </p>
      </section>
      <section className="current__data-info">
        <p>
          Stacja meteo: {data?.name}, {data?.sys.country}
        </p>
        <p>Stan na: {updateDate}</p>
      </section>
    </article>
  );
};

export default CurrentWeather;
